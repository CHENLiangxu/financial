{% extends "base.html" %}
{% block title %}Bill_table{% endblock %}
{% block nav %}
<div class="navbar-collapse collapse">
    <ul class="nav navbar-nav">
        <li ><a href="{%url 'item_index' %}">产品列表</a></li>
        <li ><a href="{%url 'bill_table_index' %}">账单</a></li>
    </ul>
</div>
{% endblock %}
{% block content %}
<script type="text/javascript">
  var no_pay_price = 0.0;
  var pay_price = 0.0;
</script>
<div class="jumbotron" id="#error">
{% if form.errors %}
    {% for field in form %}
        {% for error in field.errors %}
            <div class="alert alert-error">
                <strong>{{ error|escape }}</strong>
            </div>
        {% endfor %}
    {% endfor %}
    {% for error in form.non_field_errors %}
        <div class="alert alert-error">
            <strong>{{ error|escape }}</strong>
        </div>
    {% endfor %}
{% endif %}
</div>
<div class="jumbotron" id="table">
{% if bill_table_list %}
 <table class="table">
   <thead>
     <tr><td>#</td><td>时间</td><td>备注</td><td>总价</td><td>状态</td><td>操作</td></tr>
   </thead>
   <tbody>
  {% for bill_table in bill_table_list %}
  	<tr>
  	<td>{{bill_table.id}}</td>
  	<td>{{bill_table.created_at}}</td>
  	<td>{{bill_table.comment}}</td>
  	<td>{{bill_table.total_price}}</td>
    {% if bill_table.is_pay %}
    <td>已付款
      <script type="text/javascript">
        pay_price = {{ bill_table.total_price }} + pay_price;
      </script>
    </td>
    {% else %}
    <td>
      未付款
      <script type="text/javascript">
        no_pay_price = {{ bill_table.total_price }} + no_pay_price;
      </script>
    </td>
    {% endif %}
    <td><a href="{% url 'bill_table_detail' bill_table.id %}">编辑</a></td>
  	</tr>
  {% endfor %}
 </tbody>
 </table>
 {% endif %}

 <p class="bg-info">
   <script type="text/javascript">
   var total_price = no_pay_price + pay_price
      document.write('未付款: '+ no_pay_price + '<br />' + '已付款: '+ pay_price + '<br />' + '合计: '+ total_price);
  </script>
</p>
 
 </div>
 <div class="jumbotron" id="#form">
<form action="{% url 'add_bill_table' %}" method="post" class="form-horizontal" role="form">
{% csrf_token %}
<div class="form-group">
      <label class="col-sm-2 control-label">备注</label>
      <div class="col-sm-10">
         <input type="text" class="form-control" name="comment" placeholder="添加备注" />
      </div>
</div>
<div class="form-group">
  <div class="col-sm-offset-2 col-sm-10">
    <input type="submit" value="新建账单" class="btn btn-primary"/>
  </div>
</div>
</form>
</div>
{% endblock %}